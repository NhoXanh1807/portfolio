---
import BaseHead from "../components/BaseHead.astro";
import Footer from "../components/Footer.astro";
import FormattedDate from "../components/FormattedDate.astro";
import Header from "../components/Header.astro";

interface Props {
  title: string;
  summary: string;
  pubDate: Date;
  updatedDate?: Date;
  heroImage?: string;
  tags: string[];
  tools: string[];
}

const { title, summary, pubDate, updatedDate, heroImage, tags = [], tools = [] } = Astro.props as Props;
---

<html lang="en">
	<head>
		<BaseHead title={title} description={summary} />
		<style>
			main {
				width: 100%;
				margin: 0;
			}
			.hero {
				width: 100%;
			}
			.hero img {
				display: block;
				margin: 0 auto;
				border-radius: 16px;
				box-shadow: var(--box-shadow);
				max-height: 420px;
				object-fit: cover;
				width: 100%;
			}
			.prose {
				width: min(960px, calc(100% - 2.5rem));
				margin: auto;
				padding: 2.5rem 1rem 4rem;
				color: rgb(var(--gray-dark));
			}
			.header-block {
				text-align: center;
				margin-bottom: 2.5rem;
			}
			.header-block h1 {
				margin-bottom: 1rem;
			}
			.meta {
				display: flex;
				flex-direction: column;
				gap: 0.35rem;
				align-items: center;
				color: rgba(var(--gray), 0.85);
				font-size: 0.95rem;
			}
			.pills {
				display: flex;
				flex-wrap: wrap;
				gap: 0.5rem;
				justify-content: center;
				list-style: none;
				padding: 0;
				margin: 1.5rem auto 0;
			}
			.pills li {
				padding: 0.4rem 0.9rem;
				border-radius: 999px;
				background: rgba(var(--accent), 0.14);
				color: var(--accent);
				font-weight: 600;
				letter-spacing: 0.02em;
			}
			.details-panel {
				margin: 0 auto 2.5rem;
				padding: 1.25rem 1.5rem;
				border-radius: 1rem;
				background: rgba(var(--gray-light), 0.25);
				max-width: 640px;
			}
			.details-panel h2 {
				font-size: 1.2rem;
				margin-bottom: 0.5rem;
			}
			.details-panel ul {
				margin: 0;
				padding-left: 1.15rem;
				color: rgba(var(--gray-dark), 0.95);
			}
			.prose :global(img) {
				margin: 2rem auto;
			}
			@media (max-width: 720px) {
				.prose {
					padding: 2rem 1rem 3rem;
				}
				.details-panel {
					padding: 1rem 1.1rem;
				}
			}
		</style>
	</head>
	<body>
		<Header />
		<main>
			<article>
				{heroImage && (
					<div class="hero">
						<img src={heroImage} alt={title} loading="lazy" />
					</div>
				)}
				<div class="prose">
					<div class="header-block">
						<div class="meta">
							<FormattedDate date={pubDate} />
							{updatedDate && (
								<span>Refreshed on <FormattedDate date={updatedDate} /></span>
							)}
						</div>
						<h1>{title}</h1>
						<p>{summary}</p>
					</div>
					{tools.length > 0 && (
						<div class="details-panel" role="complementary">
							<h2>Tool Stack</h2>
							<ul>
								{tools.map((tool) => (
									<li>{tool}</li>
								))}
							</ul>
						</div>
					)}
					{tags.length > 0 && (
						<ul class="pills">
							{tags.map((tag) => (
								<li>{tag}</li>
							))}
						</ul>
					)}
					<slot />
				</div>
			</article>
		</main>
		<Footer />
	</body>
</html>
